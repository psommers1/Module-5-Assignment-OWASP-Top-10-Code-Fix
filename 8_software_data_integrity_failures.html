<!--
OWASP Top 10 - Software and Data Integrity Failures
Author: Paul Sommers

VULNERABILITY: Loading external JavaScript without integrity verification
RISK: Supply chain attacks, CDN compromise, MITM attacks, malware injection
Reference: https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/
-->

<!-- ========================================================================
     VULNERABLE CODE
     ======================================================================== -->
<!--
<script src="https://cdn.example.com/lib.js"></script>
-->

<!-- ========================================================================
     SECURE FIXED CODE
     ======================================================================== -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secure External Resources</title>
    
    <!-- SOLUTION 1: Subresource Integrity (SRI) -->
    <!-- Browser verifies hash before executing script -->
    <script 
        src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
        crossorigin="anonymous">
    </script>
    
    <!-- SOLUTION 2: Content Security Policy (CSP) -->
    <!-- Only allow scripts from approved sources -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' https://code.jquery.com;
        style-src 'self' https://fonts.googleapis.com;
    ">
    
    <!-- SOLUTION 3: Self-Hosting (Best Practice) -->
    <!-- Host critical libraries on your own server -->
    <script src="/js/vendor/library-v1.2.3.min.js"></script>
    
</head>
<body>
    <h1>Secure Resource Loading</h1>
</body>
</html>

<!--
HOW THE FIX WORKS:
- SRI: Browser computes hash and verifies match before execution
- CSP: Whitelist only approved domains for scripts
- Self-hosting: Complete control, no external dependencies
- Version pinning: Use specific versions, never 'latest'

Generate SRI hash:
$ wget https://code.jquery.com/jquery-3.6.0.min.js
$ openssl dgst -sha384 -binary jquery-3.6.0.min.js | openssl base64 -A

Reference: https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity
-->